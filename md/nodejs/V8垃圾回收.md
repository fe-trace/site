### V8垃圾回收算法

### 回收算法
V8主要采用分代垃圾回收算法：按照对象的存活时间将内存的垃圾回收进行不同的分代，然后针对不同的分代实施高效的算法。

### 内存分代
老生代对象：存活时间较长或常驻内存的对象
新生代对象：存活时间较短的对象

### Scavenge 算法
新生代主要通过Scavenge算法进行垃圾回收，在Scavenge算法的具体实现中，主要采用了Cheney算法。Cheney算法是一种复制算法，将堆空间一分为二。每次只使用其中一半空间（From），另一半空间闲置（To）。当分配空间时先分配From空间；垃圾回收时检查From空间中的存活对象，并将其复制到From空间。完成复制后From空间和To空间的角色交换。算法采用空间换时间的做法，所以对于大空间的内存分配不适用（只能使用一半的堆空间）。对于存活时间较短的新生代对象该算法比较契合。

### 新生代对象晋升
1.新生代对象在From空间和To空间经过多次翻转之后依然存在则会将对象复制到老生代空间进行管理
2.如果垃圾回收过程中To空间的使用率超过25%，则将对象复制到老生代空间进行管理

### Mark-Sweep和Mark-Compact
Mark-Sweep算法属于标记清除，分为标记和清除两个阶段。在标记阶段只标记存活的对象，清除阶段将未标记的对象清除。Mark-Sweep算法缺点在于标记之后内存会存在不连续状态。如果此时分配一个大对象空闲内存足够但是不连续，可能提前触发下一次垃圾回收。
Mark-Compact算法属于标记整理，该算法由Mark-Sweep演变而来，区别在于整理阶段将存活的对象往一端移动，移动完成后直接清理掉内存边界外的内存。此算法有整理内存的过程，效率会比Mark-Sweep低。所以V8中会主要使用Mark-Sweep算法，只有在内存不足以为晋升对象分配内存的前提才会使用Mark-Compact算法。